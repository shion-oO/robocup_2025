<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>éšœå®³ç‰©</title>
  <style>
    body {
      font-family: 'Helvetica Neue', sans-serif;
      background-color: #f0f4f8;
      margin: 0;
      padding: 0;
      color: #2c3e50;
    }

    header {
      background-color: #3498db;
      color: white;
      padding: 20px;
      text-align: center;
    }

    h1 {
      margin: 0;
      font-size: 2em;
    }

    nav {
      background-color: #ecf0f1;
      padding: 10px 20px;
      text-align: center;
    }

    nav a {
      color: #3498db;
      text-decoration: none;
      margin: 0 15px;
      font-weight: bold;
    }

    nav a:hover {
      text-decoration: underline;
    }

    main {
      padding: 40px 20px;
      max-width: 1200px;
      margin: 0 auto;
      background-color: #ffffff;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    video {
      width: 100%;
      max-width: 640px;
      border-radius: 10px;
      display: block;
      margin: 0 auto;
    }

    .caption {
      margin-top: 12px;
      font-size: 16px;
      color: #444;
      text-align: center;
    }

    h2 {
      color: #3498db;
      border-bottom: 2px solid #3498db;
      padding-bottom: 5px;
      margin-top: 40px;
    }

    .code-section {
      display: flex;
      gap: 20px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .code-box {
      flex: 1;
      min-width: 400px;
      background: #f7f9fb;
      border-radius: 10px;
      padding: 20px;
      overflow-x: auto;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    pre {
      margin: 0;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      line-height: 1.5;
      color: #333;
    }

    .desc-box {
      flex: 1;
      min-width: 400px;
      background: #eaf4fc;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .desc-box p {
      margin-bottom: 10px;
      line-height: 1.6;
    }

    /* â–¼ å­¦ç¿’ã‚»ã‚¯ã‚·ãƒ§ãƒ³ â–¼ */
    .learn-section {
      margin-top: 60px;
      background-color: #f7f9fb;
      padding: 40px 30px;
      border-radius: 10px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    }

    .learn-section h2 {
      text-align: center;
      font-size: 1.8em;
      color: #3498db;
      border-bottom: none;
      margin-bottom: 20px;
    }

    .learn-section p {
      font-size: 1.1em;
      line-height: 1.8;
      color: #2c3e50;
      margin-bottom: 15px;
    }

    .learn-list {
      list-style: decimal;
      padding-left: 25px;
      font-size: 1.05em;
      line-height: 1.8;
    }


     footer {
      text-align:center;
      padding:20px;
      background-color:#ecf0f1;
      margin-top:20px;
      border-radius:6px;
    }


        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’å·¦ã«å›ºå®š */
.sidebar {
  position: fixed;       /* ç”»é¢ã«å›ºå®š */
  top: 0;                /* ä¸Šã‹ã‚‰0 */
  left: 0;               /* å·¦ã‹ã‚‰0 */
  height: 100%;          /* ç”»é¢ã®é«˜ã•ã„ã£ã±ã„ */
  width: 250px;          /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®å¹… */
  background-color: #ecf0f1;
  padding: 20px;
  box-shadow: 2px 0 8px rgba(0,0,0,0.1);
  overflow-y: auto;      /* é«˜ã•ã‚ªãƒ¼ãƒãƒ¼ã—ãŸã‚‰ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« */
  transform: translateX(-100%); /* åˆæœŸã¯ç”»é¢å¤–ã«éš ã™ */
  transition: transform 0.3s ease;
  z-index: 1000;
}

/* é–‹ã„ãŸçŠ¶æ…‹ */
.sidebar.open {
  transform: translateX(0);
}

/* ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ä½ç½®èª¿æ•´ */
.menu-icon {
  position: fixed;
  top: 20px;
  left: 20px;
  z-index: 1100;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  gap: 5px;
}
.menu-icon div {
  width: 30px;
  height: 4px;
  background-color: #e3f2fd;
  border-radius: 2px;
}


         /* å³ä¸Šã®æ¬¡ã¸ãƒœã‚¿ãƒ³ */
    #nextButton {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      box-shadow: 0 3px 6px rgba(0,0,0,0.2);
      z-index: 2000;
      transition: 0.3s;
    }

    #nextButton:hover {
      background-color: #2980b9;
    }



  </style>
</head>
<body>


   <div class="wrapper">

  <!-- ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ -->
  <div class="menu-icon" id="menuIcon" onclick="toggleMenu()">
    <div></div><div></div><div></div>
  </div>

  <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
  <nav class="sidebar" id="sidebar">
    <ul>
      <li>
        <details>
          <summary>ã¯ã˜ã‚ã«</summary>
          <ul>
            <li><a href="robocup_home.html">ãƒ­ãƒœã‚«ãƒƒãƒ—ã‚¸ãƒ¥ãƒ‹ã‚¢ã«ã¤ã„ã¦</a></li>
          </ul>
        </details>
      </li>
      <li>
        <details>
          <summary>1. ãƒ«ãƒ¼ãƒ«</summary>
          <ul>
            <li><a href="gaiyou.html">æ¦‚è¦</a></li>
            <li><a href="koudoukihann.html">è¡Œå‹•è¦ç¯„</a></li>
            <li><a href="field.html">ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</a></li>
            <li><a href="robot.html">ãƒ­ãƒœãƒƒãƒˆ</a></li>
            <li><a href="kyougi.html" style="color:#3498db;">ç«¶æŠ€</a></li>
          </ul>
        </details>
      </li>
      <li>
        <details>
          <summary>2. å®Ÿè·µ</summary>
          <ul>
            <li><a href="linetrace.html">ç™½é»’ãƒ©ã‚¤ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¹</a></li>
            <li><a href="linetrace2.html">äº¤å·®ç‚¹ä»˜ããƒ©ã‚¤ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¹</a></li>
            <li><a href="linetrace3.html">ã‚®ãƒ£ãƒƒãƒ—ãƒ©ã‚¤ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¹</a></li>
            <li><a href="goal.html">ã‚´ãƒ¼ãƒ«ã‚¿ã‚¤ãƒ«</a></li>
            <li><a href="speedbanmp.html">ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒãƒ³ãƒ—</a></li>
            <li><a href="syougaibutu.html">éšœå®³ç‰©</a></li>
            <li><a href="gareki.html">ç“¦ç¤«</a></li>
            <li><a href="seesaw.html">ã‚·ãƒ¼ã‚½ãƒ¼</a></li>
            <li><a href="keisyaro.html">å‚¾æ–œè·¯</a></li>
            <li><a href="ball1.html">ãƒœãƒ¼ãƒ«æ¤œçŸ¥ã®å­¦ç¿’</a></li>
            <li><a href="blackball.html">é»’è‰²ãƒœãƒ¼ãƒ«</a></li>
            <li><a href="silverball.html">éŠ€è‰²ãƒœãƒ¼ãƒ«</a></li>
          </ul>
        </details>
      </li>
    </ul>
  </nav>

  <!-- å³ä¸Šå›ºå®š æ¬¡ã¸ãƒœã‚¿ãƒ³ -->
  <a href="gareki.html" id="nextButton">æ¬¡ã¸ â†’</a>

  <header>
    <h1>éšœå®³ç‰©</h1>
  </header>

  <nav>
    <a href="robocup_home.html">ãƒ›ãƒ¼ãƒ </a>
    <a href="speedbanmp.html">ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒãƒ³ãƒ—</a>
    <a href="gareki.html">ç“¦ç¤«</a>
    <a href="seesaw.html">ã‚·ãƒ¼ã‚½ãƒ¼</a>
    <a href="keisyaro.html">å‚¾æ–œè·¯</a>
  </nav>

  <main>
    <video controls>
      <source src="syougaibutu.mp4" type="video/mp4">
      ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯å‹•ç”»å†ç”Ÿã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€‚
    </video>
    <div class="caption">
  ã“ã®å‹•ç”»ã§ã¯ã€ãƒ­ãƒœãƒƒãƒˆãŒéšœå®³ç‰©ã‚’é¿ã‘ãªãŒã‚‰ãƒ©ã‚¤ãƒ³ã‚’è¿½å¾“ã™ã‚‹æ§˜å­ã‚’æ’®å½±ã—ã¦ã„ã¾ã™ã€‚<br>
  å›é¿å‹•ä½œã®ç›´å¾Œã¯ã€ãƒ©ã‚¤ãƒ³ãŒã‚«ãƒ¡ãƒ©ã®è¦–é‡ã‹ã‚‰ä¸€æ™‚çš„ã«è¦‹ãˆãªããªã‚‹å ´é¢ãŒã‚ã‚Šã¾ã™ãŒã€<br>
  ã“ã‚Œã¯ãƒ©ã‚¤ãƒ³å¾©å¸°ã®å‹•ä½œã‚„è¦–é‡èª¿æ•´ã‚’è€ƒãˆã‚‹æ•™æä¸Šã®ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ç†è§£ã§ãã¾ã™ã€‚<br>
  å›é¿ä¸­ã«èª¤æ¤œçŸ¥ã‚’é˜²ããŸã‚ã€ãƒ©ã‚¤ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¹å‡¦ç†ã‚’ä¸€æ™‚åœæ­¢ã™ã‚‹å·¥å¤«ã‚‚å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚<br><br>
  ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€å›é¿ã¨ãƒ©ã‚¤ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¹ã®åŸºæœ¬çš„ãªå‡¦ç†ã®æµã‚Œã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚<br>
  ã¾ãŸã€èµ°è¡Œã‚’å®‰å®šã•ã›ã‚‹ãŸã‚ã®å…·ä½“çš„ãªæ”¹å–„ãƒ’ãƒ³ãƒˆã‚‚ã¾ã¨ã‚ã¦ã„ã¾ã™ã®ã§ã€ãœã²å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
</div>




    <h2>choonpa.py</h2>
    <div class="code-section">
      <div class="code-box">
        <pre><code># --- 1.ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ ---
import cv2
import numpy as np
from picamera2 import Picamera2
from etrobo_python import ETRobo, Motor, SonarSensor
import time

# --- 2.ã‚«ãƒ¡ãƒ©ã®åˆæœŸè¨­å®š ---
cam0 = Picamera2(0)
cam0.configure(cam0.create_preview_configuration(main={"format": 'XRGB8888', "size": (320, 240)}))
cam0.start()
time.sleep(1)

cam1 = Picamera2(1)
cam1.configure(cam1.create_preview_configuration(main={"format": 'XRGB8888', "size": (320, 240)}))
cam1.start()
time.sleep(1)

last_direction = "CENTER"
avoid_mode = False  # éšœå®³ç‰©å›é¿ãƒ¢ãƒ¼ãƒ‰ãƒ•ãƒ©ã‚°

# --- 3.ãƒ©ã‚¤ãƒ³ã®ä½ç½®ã‹ã‚‰é€²è¡Œæ–¹å‘ã‚’åˆ¤å®šã™ã‚‹é–¢æ•° ---
def get_direction(frame, last_direction):
    hsv = cv2.cvtColor(frame, cv2.COLOR_RGB2HSV)
    lower_black = (0, 0, 0)
    upper_black = (180, 255, 80)
    mask = cv2.inRange(hsv, lower_black, upper_black)
    mask = cv2.GaussianBlur(mask, (5, 5), 0)

    height, width = mask.shape
    roi_height = 40
    roi_bottom = mask[height - roi_height:height, :]  # ä¸‹éƒ¨ã®ROIï¼ˆãƒ©ã‚¤ãƒ³æ¤œå‡ºç”¨é ˜åŸŸï¼‰
    roi_debug = cv2.cvtColor(mask.copy(), cv2.COLOR_GRAY2BGR)

    contours, _ = cv2.findContours(roi_bottom, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
    cx_list = []
    for c in contours:
        if cv2.contourArea(c) > 400:  # å°ã•ã„ãƒã‚¤ã‚ºã‚’é™¤å»
            M = cv2.moments(c)
            if M["m00"] != 0:
                cx = int(M["m10"] / M["m00"])
                cy = int(M["m01"] / M["m00"])
                cx_list.append(cx)
                cv2.circle(roi_debug, (cx, cy + height - roi_height), 5, (0, 255, 0), -1)

    direction = last_direction
    tolerance = 20  # è¨±å®¹ç¯„å›²
    if cx_list:
        avg_cx = sum(cx_list) // len(cx_list)
        if avg_cx < width // 2 - tolerance:
            direction = "LEFT"   # å·¦ã¸
        elif avg_cx > width // 2 + tolerance:
            direction = "RIGHT"  # å³ã¸
        else:
            direction = "CENTER" # ã¾ã£ã™ã
    else:
        direction = last_direction  # ãƒ©ã‚¤ãƒ³ãŒè¦‹ãˆãªã„ã¨ãã¯å‰å›ã®æ–¹å‘ã‚’ç¶­æŒ

    return direction, roi_debug

# --- 4.ãƒ©ã‚¤ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¹ã¨éšœå®³ç‰©å›é¿ã‚’åŒæ™‚ã«è¡Œã†ãƒ¡ã‚¤ãƒ³é–¢æ•° ---
def line_trace_and_avoid(right_motor: Motor, left_motor: Motor, sonar: SonarSensor):
    global last_direction, avoid_mode

    try:
        distance = sonar.get_distance()
        print(f"Sonar distance: {distance} mm")

        if avoid_mode:
            # éšœå®³ç‰©ã‚’é¿ã‘ãŸã‚ã¨ã®èµ°è¡ŒçµŒè·¯ï¼ˆé¿ã‘çµ‚ã‚ã‚Šå‹•ä½œï¼‰
            left_motor.set_power(60)
            right_motor.set_power(30)
            time.sleep(1.3)

            left_motor.set_power(30)
            right_motor.set_power(60)
            time.sleep(1.1)

            avoid_mode = False
            return

        if distance < 270:
            print("[AVOID] éšœå®³ç‰©ã‚’æ¤œå‡ºï¼ å›é¿å‹•ä½œã‚’é–‹å§‹ã—ã¾ã™...")
            avoid_mode = True
            return

        # ã‚«ãƒ¡ãƒ©ã‹ã‚‰æ˜ åƒã‚’å–å¾—
        frame0 = cam0.capture_array()
        frame1 = cam1.capture_array()

        direction, debug_mask0 = get_direction(frame0, last_direction)
        _, debug_mask1 = get_direction(frame1, last_direction)
        last_direction = direction

        print("Direction:", direction)

        # åŸºæœ¬é€Ÿåº¦ã‚’è¨­å®šï¼ˆæ–¹å‘ã«ã‚ˆã‚Šèª¿æ•´ï¼‰
        base = 35 if direction == "CENTER" else 30
        diff = 25

        if direction == "LEFT":
            right_motor.set_power(base + diff)
            left_motor.set_power(base - diff)
        elif direction == "RIGHT":
            right_motor.set_power(base - diff)
            left_motor.set_power(base + diff)
        else:
            right_motor.set_power(base)
            left_motor.set_power(base)

        # ã‚«ãƒ¡ãƒ©æ˜ åƒã‚’è¡¨ç¤ºï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
        cv2.imshow("Cam0 Mask", debug_mask0)
        cv2.imshow("Cam1 Mask", debug_mask1)
        cv2.waitKey(1)

    except Exception as e:
        print("[ERROR]:", e)

# --- 5.å®Ÿè¡Œéƒ¨åˆ† ---
(ETRobo(backend='raspyke')
 .add_device('right_motor', device_type=Motor, port='B')
 .add_device('left_motor', device_type=Motor, port='C')
 .add_device('sonar', device_type=SonarSensor, port='S1')
 .add_handler(line_trace_and_avoid)
 .dispatch(interval=0.05))


</code></pre>
      </div>

<div class="desc-box" style="background:#f7f9fc; padding:20px; border-radius:12px; line-height:1.8; color:#333;">
  <p><b style="color:#000;">1. ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ï¼ˆé“å…·ç®±ã‚’ç”¨æ„ã™ã‚‹éƒ¨åˆ†ï¼‰</b></p>

  <p>
    <b style="color:#000;">cv2ï¼ˆOpenCVï¼‰</b>ï¼šç”»åƒå‡¦ç†ã®ãŸã‚ã€‚è‰²å¤‰æ›ã€ãƒã‚¹ã‚¯ä½œæˆã€è¼ªéƒ­æ¤œå‡ºãªã©ã‚’ã—ã¾ã™ã€‚<br>
    <b style="color:#000;">numpyï¼ˆnpï¼‰</b>ï¼šé…åˆ—è¨ˆç®—ã‚’ä¾¿åˆ©ã«ã™ã‚‹ã€‚ç”»åƒã¯é…åˆ—ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚<br>
    <b style="color:#000;">Picamera2</b>ï¼šRaspberry Pi ã®ã‚«ãƒ¡ãƒ©ã‚’æ‰±ã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚<br>
    <b style="color:#000;">ETRobo / Motor / SonarSensor</b>ï¼šãƒ­ãƒœãƒƒãƒˆæœ¬ä½“ãƒ»ãƒ¢ãƒ¼ã‚¿ãƒ¼ãƒ»è¶…éŸ³æ³¢ã‚»ãƒ³ã‚µãƒ¼ã‚’å‹•ã‹ã™ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚<br>
    <b style="color:#000;">time</b>ï¼šå¾…ã¡æ™‚é–“ï¼ˆsleepï¼‰ã«ä½¿ã„ã¾ã™ã€‚
  </p>

  <p><b style="color:#000;">2. ã‚«ãƒ¡ãƒ©ã®åˆæœŸè¨­å®šï¼ˆcam0, cam1ï¼‰</b></p>
  <p>
    <b style="color:#000;">Picamera2(0)</b> ã¨ <b style="color:#000;">Picamera2(1)</b>ï¼š2å°ã®ã‚«ãƒ¡ãƒ©ã‚’æƒ³å®šï¼ˆ0 ãŒ1å°ç›®ã€1 ãŒ2å°ç›®ï¼‰ã€‚<br>
    <b style="color:#000;">size=(320,240)</b>ï¼šç”»åƒã‚µã‚¤ã‚ºã‚’å°ã•ãã—ã¦å‡¦ç†ã‚’é€Ÿãã—ã¦ã„ã¾ã™ï¼ˆå°ã•ã„ã¨è»½ã„ãŒã€ç´°ã‹ã„ç·šã¯è¦‹ãˆã«ãã„ï¼‰ã€‚<br>
    <b style="color:#000;">time.sleep(1)</b>ï¼šã‚«ãƒ¡ãƒ©ã®èµ·å‹•å¾…ã¡ã€‚ã‚«ãƒ¡ãƒ©ã¯èµ·å‹•ç›´å¾Œã«æ˜ã‚‹ã•ã‚„è‰²ãŒå®‰å®šã—ãªã„ã“ã¨ãŒã‚ã‚‹ã®ã§å¾…ã¡ã¾ã™ã€‚<br>
    <b style="color:#000;">last_direction</b>ï¼šå‰å›ã®é€²è¡Œæ–¹å‘ï¼ˆ"LEFT" / "RIGHT" / "CENTER"ï¼‰ã‚’è¦šãˆã¦ãŠãã¾ã™ã€‚ç·šãŒè¦‹ãˆãªã„ç¬é–“ã®æŒ™å‹•å®‰å®šåŒ–ã«ä½¿ã†ã€‚<br>
    <b style="color:#000;">avoid_mode</b>ï¼šéšœå®³ç‰©å›é¿ä¸­ã‹ã©ã†ã‹ã‚’ç¤ºã™ãƒ•ãƒ©ã‚°ï¼ˆTrue/Falseï¼‰ã€‚
  </p>

  <p><b style="color:#000;">3. get_direction é–¢æ•° â€” ç”»åƒã‹ã‚‰ãƒ©ã‚¤ãƒ³ã®æ–¹å‘ã‚’æ¨å®šã™ã‚‹ï¼ˆè¶…é‡è¦ï¼‰</b></p>
  <p>
    è‰²ç©ºé–“ã®å¤‰æ›ï¼ˆRGB â†’ HSVï¼‰<br>
    <b style="color:#000;">hsv = cv2.cvtColor(frame, cv2.COLOR_RGB2HSV)</b><br><br>

    é»’è‰²ã®é ˜åŸŸã ã‘å–ã‚Šå‡ºã™ï¼ˆãƒã‚¹ã‚¯ä½œæˆï¼‰<br>
    <b style="color:#000;">lower_black = (0, 0, 0)</b><br>
    <b style="color:#000;">upper_black = (180, 255, 80)</b><br>
    <b style="color:#000;">mask = cv2.inRange(hsv, lower_black, upper_black)</b><br><br>

    ã¼ã‹ã—ï¼ˆãƒã‚¤ã‚ºé™¤å»ï¼‰<br>
    <b style="color:#000;">mask = cv2.GaussianBlur(mask, (5, 5), 0)</b><br><br>

    ROIï¼ˆä¸‹ã®40ãƒ”ã‚¯ã‚»ãƒ«ã ã‘è¦‹ã‚‹ï¼‰<br>
    <b style="color:#000;">height, width = mask.shape</b><br>
    <b style="color:#000;">roi_height = 40</b><br>
    <b style="color:#000;">roi_bottom = mask[height - roi_height:height, :]</b><br><br>

    è¼ªéƒ­æ¤œå‡º<br>
    <b style="color:#000;">contours, _ = cv2.findContours(roi_bottom, ...)</b><br><br>

    é‡å¿ƒï¼ˆcxï¼‰ã‚’è¨ˆç®—ã—ã¦ä½ç½®ã‚’å¾—ã‚‹<br>
    <b style="color:#000;">if cv2.contourArea(c) > 400:</b><br>
    &nbsp;&nbsp;<b style="color:#000;">M = cv2.moments(c)</b><br>
    &nbsp;&nbsp;<b style="color:#000;">cx = int(M["m10"] / M["m00"])</b><br><br>

    å¹³å‡cxã§å·¦å³åˆ¤å®š<br>
    <b style="color:#000;">avg_cx = sum(cx_list) // len(cx_list)</b><br>
    <b style="color:#000;">tolerance = 20</b><br>
    <b style="color:#000;">if avg_cx < width // 2 - tolerance: direction = "LEFT"</b><br>
    <b style="color:#000;">elif avg_cx > width // 2 + tolerance: direction = "RIGHT"</b><br>
    <b style="color:#000;">else: direction = "CENTER"</b><br><br>

    ãƒ©ã‚¤ãƒ³ãŒè¦‹ãˆãªã„å ´åˆ<br>
    <b style="color:#000;">else: direction = last_direction</b>
  </p>

  <p><b style="color:#000;">4. line_trace_and_avoid é–¢æ•° â€” ãƒ©ã‚¤ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¹ã¨éšœå®³ç‰©å›é¿ã‚’çµ„ã¿åˆã‚ã›ãŸãƒ¡ã‚¤ãƒ³å‡¦ç†</b></p>
  <p>
    è¶…éŸ³æ³¢ã‚»ãƒ³ã‚µãƒ¼ã§è·é›¢ã‚’æ¸¬ã‚‹<br>
    <b style="color:#000;">distance = sonar.get_distance()</b><br><br>

    å›é¿ä¸­ãªã‚‰ã€Œå›é¿å¾Œã®å¾©å¸°å‹•ä½œã€ã‚’è¡Œã†<br>
    <b style="color:#000;">if avoid_mode:</b><br>
    &nbsp;&nbsp;<b style="color:#000;">left_motor.set_power(60)</b><br>
    &nbsp;&nbsp;<b style="color:#000;">right_motor.set_power(30)</b><br>
    &nbsp;&nbsp;<b style="color:#000;">time.sleep(1.3)</b><br>
    &nbsp;&nbsp;<b style="color:#000;">left_motor.set_power(30)</b><br>
    &nbsp;&nbsp;<b style="color:#000;">right_motor.set_power(60)</b><br>
    &nbsp;&nbsp;<b style="color:#000;">time.sleep(1.1)</b><br>
    &nbsp;&nbsp;<b style="color:#000;">avoid_mode = False</b><br>
    &nbsp;&nbsp;<b style="color:#000;">return</b><br><br>

    ã‚‚ã—è·é›¢ãŒé–¾å€¤ï¼ˆã“ã“ã§ã¯270mmï¼‰ã‚ˆã‚Šè¿‘ã‘ã‚Œã°å›é¿é–‹å§‹<br>
    <b style="color:#000;">if distance < 270:</b><br>
    &nbsp;&nbsp;<b style="color:#000;">avoid_mode = True</b><br>
    &nbsp;&nbsp;<b style="color:#000;">return</b><br><br>

    ãƒ¢ãƒ¼ã‚¿ãƒ¼ã¸å‡ºåŠ›ï¼ˆèµ°è¡Œåˆ¶å¾¡ï¼‰<br>
    <b style="color:#000;">base = 35 if direction == "CENTER" else 30</b><br>
    <b style="color:#000;">diff = 25</b><br>
    <b style="color:#000;">if direction == "LEFT":</b><br>
    &nbsp;&nbsp;<b style="color:#000;">right_motor.set_power(base + diff)</b><br>
    &nbsp;&nbsp;<b style="color:#000;">left_motor.set_power(base - diff)</b><br>
    ...<br><br>

    ãƒ‡ãƒãƒƒã‚°è¡¨ç¤º<br>
    <b style="color:#000;">cv2.imshow("Cam0 Mask", debug_mask0)</b><br>
    <b style="color:#000;">cv2.imshow("Cam1 Mask", debug_mask1)</b><br>
    <b style="color:#000;">cv2.waitKey(1)</b><br><br>

    ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†<br>
    <b style="color:#000;">except Exception as e:</b><br>
    &nbsp;&nbsp;<b style="color:#000;">print("[ERROR]:", e)</b>
  </p>

  <p><b style="color:#000;">5. å®Ÿè¡Œéƒ¨åˆ†ï¼ˆETRoboã®è¨­å®šï¼‰</b></p>
  <p>
    <b style="color:#000;">add_device</b>ï¼šãƒ¢ãƒ¼ã‚¿ãƒ¼ã‚„ã‚»ãƒ³ã‚µãƒ¼ã®ç™»éŒ²ï¼ˆå³ãƒ¢ãƒ¼ã‚¿ãƒ¼ã‚’Bãƒãƒ¼ãƒˆã€å·¦ã‚’Cãƒãƒ¼ãƒˆã€ã‚½ãƒŠãƒ¼ã‚’S1ãƒãƒ¼ãƒˆã«æ¥ç¶šï¼‰ã€‚<br>
    <b style="color:#000;">add_handler(line_trace_and_avoid)</b>ï¼šå…ˆã»ã©ã®é–¢æ•°ã‚’å®šæœŸçš„ã«å®Ÿè¡Œã™ã‚‹ã‚ˆã†ç™»éŒ²ã€‚<br>
    <b style="color:#000;">dispatch(interval=0.05)</b>ï¼š0.05ç§’ï¼ˆ50ãƒŸãƒªç§’ï¼‰ã”ã¨ã« line_trace_and_avoid ã‚’å‘¼ã¶ã€‚ã“ã‚ŒãŒãƒ­ãƒœãƒƒãƒˆã®åˆ¶å¾¡ãƒ«ãƒ¼ãƒ—ã®å‘¨æœŸã§ã™ï¼ˆ20Hzï¼‰ã€‚
  </p>
</div>
<!-- â–¼ ã‚ˆãã‚ã‚‹å•é¡Œã¨æ”¹å–„ã®ãƒ’ãƒ³ãƒˆ â–¼ -->
<div class="tips-section">
  <h2>ã‚ˆãã‚ã‚‹å•é¡Œã¨æ”¹å–„ã®ãƒ’ãƒ³ãƒˆ</h2>
  <div class="tips-grid">

    <!-- 1 -->
    <article class="card">
      <h3>ğŸš— ã¾ã£ã™ãé€²ã¾ãªã„</h3>
      <p>ãƒ»å·¦å³ãƒ¢ãƒ¼ã‚¿ãƒ¼ã®å‡ºåŠ›ãƒãƒ©ãƒ³ã‚¹ã‚’ç¢ºèª<br>
         ãƒ»ã‚¿ã‚¤ãƒ¤ã®æ‘©è€—ã§é€²è¡Œæ–¹å‘ãŒãšã‚Œã‚‹ã“ã¨ã‚‚<br>
         ãƒ»<code>base_speed</code> ã‚’å¾®èª¿æ•´ã™ã‚‹</p>
      <p class="tip-label green">âš™ï¸ ãƒãƒ©ãƒ³ã‚¹ã‚’æ•´ãˆã‚ˆã†ï¼</p>
    </article>

    <!-- 2 -->
    <article class="card">
      <h3>ğŸ•µï¸â€â™‚ï¸ ãƒ©ã‚¤ãƒ³ã‚’è¦‹å¤±ã†</h3>
      <p>ãƒ»ã‚«ãƒ¡ãƒ©ã®é«˜ã•ã‚„è§’åº¦ã‚’èª¿æ•´<br>
         ãƒ»ROIï¼ˆæ¤œå‡ºç¯„å›²ï¼‰ã‚’åºƒã’ã‚‹<br>
         ãƒ»æ˜ã‚‹ã•ã‚’ä¸Šã’ã‚‹ï¼ãƒ©ã‚¤ãƒˆã‚’ä½¿ç”¨</p>
      <p class="tip-label blue">ğŸ” ã‚«ãƒ¡ãƒ©èª¿æ•´ãŒã‚«ã‚®ï¼</p>
    </article>

    <!-- 3 -->
    <article class="card">
      <h3>âš« å½±ã‚„åºŠã‚’é»’ã¨åˆ¤å®šã—ã¦ã—ã¾ã†</h3>
      <p>ãƒ»é»’ã®ã—ãã„å€¤ãŒåºƒã™ãã‚‹<br>
         ãƒ»å½±ã‚„æš—ã„éƒ¨åˆ†ã‚‚é»’ã¨èªè­˜ã—ãŒã¡<br>
         ãƒ»HSVã®é»’åˆ¤å®šã‚’å¾®èª¿æ•´ã™ã‚‹</p>
      <p class="tip-label green">ğŸ¨ ã—ãã„å€¤ã‚’èª¿æ•´ï¼</p>
    </article>

    <!-- 4 -->
    <article class="card">
      <h3>â†”ï¸ å·¦å³ãŒé€†ã«ãªã‚‹</h3>
      <p>ãƒ»ã‚«ãƒ¡ãƒ©æ˜ åƒãŒå·¦å³åè»¢ã—ã¦ã„ã‚‹<br>
         ãƒ»<code>cv2.flip(frame, 1)</code> ã‚’ä½¿ã†<br>
         ãƒ»ãƒ¢ãƒ¼ã‚¿ãƒ¼ã®A/Bæ¥ç¶šã‚’ç¢ºèª</p>
      <p class="tip-label blue">ğŸ§­ æ˜ åƒã¨æ¥ç¶šã‚’ãƒã‚§ãƒƒã‚¯ï¼</p>
    </article>

    <!-- 5 -->
    <article class="card">
      <h3>ğŸ›‘ å›é¿å¾Œã«ãƒ©ã‚¤ãƒ³ã¸æˆ»ã‚Œãªã„</h3>
      <p>ãƒ»å›é¿ã®è§’åº¦ãŒå¤§ããã€ãƒ©ã‚¤ãƒ³ãŒè¦–é‡å¤–ã«ãªã‚‹<br>
         ãƒ»å›é¿ä¸­ã«åˆ¥ã®é»’ã‚¿ã‚¤ãƒ«ã‚’æ‹¾ã†å¯èƒ½æ€§<br>
         ãƒ»å›é¿æ™‚ã®ã¿ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’åœæ­¢ã™ã‚‹å·¥å¤«ãŒæœ‰åŠ¹</p>
      <p class="tip-label green">ğŸ”„ å†æ¤œå‡ºã—ã‚„ã™ã„å‹•ãã«ï¼</p>
    </article>

    <!-- 6 -->
    <article class="card">
      <h3>ğŸ’¡ ã‚«ãƒ¡ãƒ©æ˜ åƒãŒæš—ã„</h3>
      <p>ãƒ»ç…§æ˜ä¸è¶³ã§ãƒ©ã‚¤ãƒ³æ¤œå‡ºãŒä¸å®‰å®š<br>
         ãƒ»ãƒ©ã‚¤ãƒˆã‚„æ˜ã‚‹ã•è£œæ­£ã§æ”¹å–„</p>
      <p class="tip-label blue">ğŸ’¡ æ˜ã‚‹ã•ã‚’ç¢ºä¿ï¼</p>
    </article>

    <!-- 7 -->
    <article class="card">
      <h3>âš¡ ãƒ¢ãƒ¼ã‚¿ãƒ¼ãŒæ€¥ã«æ­¢ã¾ã‚‹</h3>
      <p>ãƒ»ãƒãƒƒãƒ†ãƒªãƒ¼æ®‹é‡ä¸è¶³<br>
         ãƒ»ãƒ¢ãƒ¼ã‚¿ãƒ¼ã‚„é…ç·šãŒæ¥è§¦ä¸è‰¯<br>
         ãƒ»é›»æºè¨­å®šã‚’ç¢ºèªã™ã‚‹</p>
      <p class="tip-label green">ğŸ”Œ é›»æºãƒã‚§ãƒƒã‚¯ã‚’å¿˜ã‚Œãšã«ï¼</p>
    </article>

    <!-- 8 -->
    <article class="card">
      <h3>ğŸ”€ é€²è¡Œæ–¹å‘ãŒãµã‚‰ã¤ã</h3>
      <p>ãƒ»PIDï¼å·®åˆ†åˆ¶å¾¡ã®èª¿æ•´ä¸è¶³<br>
         ãƒ»å·¦å³ãƒ¢ãƒ¼ã‚¿ãƒ¼ã®ãƒ‘ãƒ¯ãƒ¼å·®ãŒåŸå› ã®ã“ã¨ã‚‚</p>
      <p class="tip-label blue">ğŸ¯ é€Ÿåº¦ãƒãƒ©ãƒ³ã‚¹ã‚’èª¿æ•´ï¼</p>
    </article>

  </div>
</div>

<style>
.tips-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  justify-content: flex-start;
}

.card {
  flex: 1 1 220px;
  max-width: 250px;
  background: #f7f9fc;
  border-radius: 10px;
  border: 1px solid #d1d5db;
  padding: 15px;
  box-shadow: 1px 1px 5px rgba(0,0,0,0.1);
}

.card h3 {
  margin-top: 0;
  font-size: 1.1em;
}

.tip-label {
  font-weight: 600;
}

.green { color: #16a34a; }
.blue  { color: #2b7bd3; }

/* ã‚¹ãƒãƒ›å¯¾å¿œ */
@media (max-width: 480px) {
  .tips-grid {
    flex-direction: column;
  }
  .card {
    max-width: 100%;
  }
}
</style>




<div class="learn-section">
  <h2>ğŸ“˜ å­¦ç¿’ã®ã‚„ã‚Šæ–¹</h2>
  <p>éšœå®³ç‰©å›é¿ã¨ãƒ©ã‚¤ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®æµã‚Œï¼š</p>
  <ol class="learn-list">
    <li>ã‚«ãƒ¡ãƒ©ã§åºŠã®é»’ç·šã‚’è¦‹ã¤ã‘ã‚‹</li>
    <li>ç·šã®ä½ç½®ã‹ã‚‰ãƒ­ãƒœãƒƒãƒˆã®é€²ã‚€æ–¹å‘ã‚’åˆ¤æ–­ã™ã‚‹</li>
    <li>å·¦å³ã®ãƒ¢ãƒ¼ã‚¿ãƒ¼é€Ÿåº¦ã‚’å¤‰ãˆã¦æ–¹å‘è»¢æ›ã™ã‚‹</li>
    <li>è¶…éŸ³æ³¢ã‚»ãƒ³ã‚µãƒ¼ã§éšœå®³ç‰©ã‚’æ¤œçŸ¥ â†’ å›é¿å‹•ä½œ</li>
    <li>ã“ã‚Œã‚’ç¹°ã‚Šè¿”ã— â†’ ãƒ­ãƒœãƒƒãƒˆãŒè‡ªå¾‹çš„ã«èµ°è¡Œ</li>
  </ol>
  <p>å®Ÿéš›ã«ãƒ­ãƒœãƒƒãƒˆã‚’å‹•ã‹ã™ã¨ã€<strong>ã€Œã‚»ãƒ³ã‚µãƒ¼ã€ã¨ã€Œç”»åƒå‡¦ç†ã€ã®ã¤ãªãŒã‚Š</strong>ãŒè‡ªç„¶ã¨ç†è§£ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
</div>


  </main>

    
      <footer>
      <p>&copy; 2025ã€€æ„›çŸ¥å·¥æ¥­å¤§å­¦ã€€æ°´é‡å‹æ•™ç ”ç©¶å®¤ </p>
    </footer>


    <script>
  function toggleMenu() {
    const sidebar = document.getElementById('sidebar');
    const menuIcon = document.getElementById('menuIcon');
    sidebar.classList.toggle('open');
    menuIcon.classList.toggle('open');
  }

  document.addEventListener('click', function(e) {
    const sidebar = document.getElementById('sidebar');
    const menuIcon = document.getElementById('menuIcon');
    if (!e.target.closest('.sidebar') && !e.target.closest('.menu-icon') && sidebar.classList.contains('open')) {
      sidebar.classList.remove('open');
      menuIcon.classList.remove('open');
    }
  });
</script>

</body>
</html>
